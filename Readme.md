# Garcia_et_al_2025

Data analysis codes for the paper:
"Noncanonical Short-Latency Auditory Pathway Directly Activates Deep Cortical Layers."
Michellee M. Garcia, Amber M Kline, Koun Onodera, Hiroaki Tsukano, Pranathi R. Dandu, Hailey C. Acosta, Michael R. Kasten, Paul B. Manis, Hiroyuki K. Kato.
Nature Communications 2025

Last updated: 2025 May 21th by Hiroyuki Kato

This repository provides MATLAB scripts used for determining linear probe trajectories to analyze auditory response properties in various brain regions.


## Medial Geniculate Body (MGB) recordings
Before running MGB scripts, you need to prepare .tif files including the brain atlas images.
We used the Paxinos and Franklin's The Mouse Brain Atlas 5th edition. We chose the Paxinos Brain Atlas over the Allen Brain Atlas for MGN mapping
because MGN boundaries, particularly for MGv, appear smaller in the Allen Brain Atlas compared to those inferred from histological analyses. 
We cannot publicly share these atlas files on GitHub due to copyright restrictions.
Please prepare these files independently or contact Hiroyuki Kato.

The atlas images should include the following anatomical ranges:
Anteroposterior (AP): Bregma -4.04 mm to -2.80 mm (11 sections)
Mediolateral (ML): 1.50 mm to 2.50 mm
Dorsoventral (DV): 2.50 mm to 4.00 mm

For example, "Bregma-2.80mm_BrainSection.tif" shows a traced brain atlas at AP -2.80mm, ML 1.5-2.5mm, DV 2.5-4mm.
Similarly, In "Bregma-2.80mm_MGB.tif" , only MGB subregions are traced within the same spatial coordinates.
If you have access to the digital atlas, these files can easily be generated by applying clipping masks in Adobe Illustrator. 

Brief descriptions of scripts:

1. create_SectionImage_dataset.m
	This code converts atlas .tif files to SectionImage.mat.

2. extract_MGBoutlines.m
	This code extracts MGB boundaries data into polygon coordinates, saving as MGBdrawdata.mat.
	
3. determine_probe_trajectory_MGB.m
	We used this code to determine the stereotaxic coordinates and brain regions of individual linear probe channels from MGB recordings.
	This code saves layer_info.mat, which stores the information about individual recorded channels. 
	
	
## Inferior Colliculus (IC) recordings
For our IC analysis, we used AP_histology (https://github.com/petersaj/AP_histology) to align probe trajectories with the Allen Common Coordinate Framework (CCF).
This code generates probe_ccf.mat, which we used to assign each linear probe channel to brain regions.

For visualizing probe trajectories within IC, we used mesh data of individual IC subdivisions extracted from the Allen CCF.
Download structure mask files from https://download.alleninstitute.org/informatics-archive/current-release/mouse_ccf/annotation/ccf_2017/structure_masks/structure_masks_10/ :
IC: structure_4.nrrd
ICc: structure_811.nrrd
ICd: structure_820.nrrd
ICe: structure_828.nrrd


Brief descriptions of scripts:

1. save_surface_mesh.m
	This code converts .nrrd mask files into surface mesh data and saves "IC_mesh.mat", "ICc_mesh.mat", "ICe_mesh.mat", and "ICd_mesh.mat".
	
2. save_layer_info_IC.m
	We used this code to determine stereotaxic coordinates and brain regions of individual linear probe channels in our IC recordings.
	This code saves layer_info.mat, which stores the information about individual recorded channels. 

3. draw_probe_trajectories_IC.mapping
	We used this code to visualize linear probe trajectories within the IC.
	
	
## Auditory Cortex (AC) recordings
Layer boundaries were defined using three features:
1. Distribution of spikes is used to determine the brain surface and white matter.
2. Current source density (CSD) responses to click stimuli are used to give the initial estimate of the layer 4.
3. Finally, cross-channel correlation is used to cluster channels into different layers.

Before running the following save_layer_info_auditory_cortex.m, pre-identify surfaceCh and whitematterCh from the spike data.
CSD was calculated using CSD.m available on MATLAB Central File Exchange at https://www.mathworks.com/matlabcentral/fileexchange/69399-current-source-density-csd.
Layer 4 (L4) was estimated as the channels in the middle layer with short-latency strong responses.
We used LFP data downsampled to 250Hz.

Brief descriptions of scripts:

1. save_layer_ifo_auditory_cortex
	Cross-channel correlation is used to determine layer boundaries.
	This method typically groups channels into layer 1, layer 2-4, layer 5, and layer 6. 
	ref: Senzai et al., Neuron 2019.  https://pubmed.ncbi.nlm.nih.gov/30635232/
	The resulting layer_info.mat file stores the layer information about individual recorded channels.
